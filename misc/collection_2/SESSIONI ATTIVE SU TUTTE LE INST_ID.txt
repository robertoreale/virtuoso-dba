-- SESSIONI ATTIVE SU TUTTE LE INST_ID

set lines 333
set pages 2000
col sid for 99999
col last_call for a8
col username for a17
col status for a8
col osuser for a16
col machine for a25
col event for a32
col sec for 99999
col i for a4
select substr(a.inst_id,1,1) as i, a.SID,        
       to_char(sysdate - last_call_et / 86400,'DDHH24MISS')  as LAST_CALL,
       a.USERNAME, STATUS, OSUSER, MACHINE, 
       substr(w.EVENT,1,28) event,
       w.SECONDS_IN_WAIT SEC
from gv$session a,
     gv$process p,
     gv$session_wait w
where a.username is not null
  and a.username <> 'DBSNMP' --and a.username <> 'SYS'
  and p.ADDR = a.pADDR
  and p.inst_id = a.inst_id
  and w.sid (+) = a.sid
  and w.inst_id (+) = a.inst_id
  and w.event not like '%SQL%client'
order by EVENT;