col i for a1
col sid for 99999
col last_call for a8
col username for a11
col status for a8
col qcsid for 99999
col osuser for a16
col machine for a24
col event for a32
col lock_on for a12
select substr(a.inst_id,1,1) as i, a.SID,
       to_char(sysdate - last_call_et / 86400,'DDHH24MISS')  as LAST_CALL,
       a.USERNAME, a.STATUS,
       substr(px.inst_id,1,1) as i,
       qcsid as QCSID,
       a.OSUSER, a.MACHINE,
       w.EVENT,
       w.SECONDS_IN_WAIT SEC
from gv$session a,
     gv$process p,
     gv$session_wait w,
     gv$px_session px
where a.username is not null
  and a.username <> 'DBSNMP' --and a.username <> 'SYS'
  and p.ADDR = a.pADDR
  and p.inst_id = a.inst_id
  and w.sid (+) = a.sid
  and w.inst_id (+) = a.inst_id
  and px.sid (+) = a.sid
  and px.inst_id (+) = a.inst_id
  and a.status='ACTIVE'
and w.event not like '%SQL%client' order by LAST_CALL;

